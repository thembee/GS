sigma2a<-20
sigma2e<-40

y<-matrix(c(
4.5,
2.9,
3.9,
3.5,
5.0), ncol=1,byrow=T)

X<-matrix(c(
1,0,
0,1,
0,1,
1,0,
1,0), ncol=2,byrow=T)

Z<-matrix(c(
0,0,0,1,0,0,0,0,
0,0,0,0,1,0,0,0,
0,0,0,0,0,1,0,0,
0,0,0,0,0,0,1,0,
0,0,0,0,0,0,0,1), ncol=8,byrow=T)

A<-matrix(c(
1.00, 0.00, 0.00, 0.500, 0.000, 0.50, 0.00, 0.250,
0.00, 1.00, 0.00, 0.000, 0.500, 0.50, 0.00, 0.250,
0.00, 0.00, 1.00, 0.000, 0.500, 0.00, 0.00, 0.500,
0.50, 0.00, 0.00, 1.000, 0.000, 0.25, 0.00, 0.125,
0.00, 0.50, 0.50, 0.000, 1.000, 0.25, 0.00, 0.375,
0.50, 0.50, 0.00, 0.250, 0.250, 1.00, 0.00, 0.500,
0.00, 0.00, 0.00, 0.000, 0.000, 0.00, 1.00, 0.000,
0.25, 0.25, 0.50, 0.125, 0.375, 0.50, 0.00, 1.000), ncol=8,byrow=T)


Ainv<-solve(A)

alpha=sigma2e/sigma2a

LHS=rbind(
	cbind( t(X)%*%X, t(X)%*%Z ) , 
	cbind(t(Z)%*%X, t(Z)%*%Z+Ainv*alpha) 
	) 
	
RHS= rbind( t(X)%*%y, t(Z)%*%y )

SOL=solve(LHS) %*% RHS


G<-matrix(c(
1.00, 0.000, 0.000, 0.600, 0.000, 0.500, 0.020, 0.200,
0.00, 1.000, 0.000, 0.000, 0.500, 0.500, 0.015, 0.250,
0.00, 0.000, 1.000, 0.000, 0.550, 0.000, 0.025, 0.450,
0.60, 0.000, 0.000, 1.000, 0.000, 0.250, 0.020, 0.200,
0.00, 0.500, 0.550, 0.000, 1.000, 0.250, 0.025, 0.375,
0.50, 0.500, 0.000, 0.250, 0.250, 1.000, 0.015, 0.500,
0.02, 0.015, 0.025, 0.020, 0.025, 0.015, 1.000, 0.200,
0.20, 0.250, 0.450, 0.200, 0.375, 0.500, 0.200, 1.000), ncol=8,byrow=T)


Ginv<-solve(G)

LHS=rbind(
	cbind( t(X)%*%X, t(X)%*%Z ) , 
	cbind(t(Z)%*%X, t(Z)%*%Z+Ginv*alpha) 
	) 
	
RHS= rbind( t(X)%*%y, t(Z)%*%y )

GSOL=solve(LHS) %*% RHS


